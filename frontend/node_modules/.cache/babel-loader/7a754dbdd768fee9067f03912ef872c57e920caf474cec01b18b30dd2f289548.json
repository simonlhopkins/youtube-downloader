{"ast":null,"code":"var _jsxFileName = \"/Users/simonhopkins/Desktop/Personal/react/music-i-listen-to/src/PlaylistContainer.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport PlaylistEntry from \"./PlaylistEntry\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst client_id = '1b352e5ba35049b1918e0b310494107e';\nconst client_secret = 'b79d65aa4cca4e389c38ad01497bb981';\nasync function getPlaylistData(token, isNewToken) {\n  async function getParsedPlaylistData(playlistsData, authToken) {\n    return Promise.all(playlistsData.items.map(async playlist => {\n      //get tracks\n      const tracks = await fetch(playlist.tracks.href, {\n        method: \"GET\",\n        headers: {\n          \"Authorization\": `Bearer ${authToken}`\n        }\n      }).then(response => response.json()).then(data => {\n        return data.items.map(track => track.track);\n      });\n      const artists = tracks.map(track => {\n        return track.artists.map(artists => {\n          return {\n            artistName: artists.name,\n            artistUrl: artists.external_urls.spotify\n          };\n        });\n      }).flat();\n      let artistSet = new Set();\n      const filteredArtists = [];\n      for (const artist of artists) {\n        if (!artistSet.has(artist.artistName)) {\n          artistSet.add(artist.artistName);\n          filteredArtists.push(artist);\n        }\n      }\n      const playlistImg = playlist.images[0];\n      const playlistUrl = playlist.external_urls.spotify;\n      return {\n        imageUrl: playlistImg.url,\n        playlistUrl: playlistUrl,\n        artists: filteredArtists\n      };\n    })).then(data => {\n      //song data\n      return data;\n    });\n  } //end get getParsedPlaylistData\n\n  const numPlaylists = 3;\n  const url = `https://api.spotify.com/v1/users/simonlhopkins/playlists?limit=${numPlaylists}`;\n  //get the parsed data\n  return fetch(url, {\n    method: \"GET\",\n    headers: {\n      \"Authorization\": `Bearer ${token}`\n    }\n  }).then(response => response.json()).then(async data => {\n    const parsedData = await getParsedPlaylistData(data, token);\n    localStorage.setItem(\"cachedPlaylistData\", JSON.stringify(parsedData));\n    return parsedData;\n  }).catch(error => console.error('Error:', error));\n}\nfunction PlaylistContainer() {\n  _s();\n  const [accessToken, setAccessToken] = useState('');\n  const [data, setData] = useState([]);\n  const [error, setError] = useState(null);\n  async function getAccessToken() {\n    const data = new URLSearchParams();\n    data.append(\"grant_type\", \"client_credentials\");\n    data.append(\"client_id\", client_id);\n    data.append(\"client_secret\", client_secret);\n    return fetch(\"https://accounts.spotify.com/api/token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      body: data\n    }).then(response => {\n      console.log(response);\n      if (!response.ok) {\n        throw new Error(`HTTP error! Status: ${response.status}`);\n      }\n      return response.json();\n    }).then(data => data.access_token).catch(error => {\n      throw error;\n    });\n  }\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const token = await getAccessToken();\n        setAccessToken(token);\n        const data = await getPlaylistData(token, true);\n        setData(data);\n      } catch (error) {\n        setError(error);\n        return;\n      }\n    };\n    fetchData();\n  }, []);\n  const children = data.map((playlistsData, index) => {\n    return /*#__PURE__*/_jsxDEV(PlaylistEntry, {\n      imageUrl: playlistsData.imageUrl,\n      artists: playlistsData.artists,\n      playlistUrl: playlistsData.playlistUrl\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }, this);\n  });\n  console.log(children);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [children.length > 0 && children, error && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Error: \", error.toString()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 23\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 134,\n    columnNumber: 9\n  }, this);\n}\n_s(PlaylistContainer, \"wy8tsdthGPF6t7EyD82ES+adbPQ=\");\n_c = PlaylistContainer;\nexport default PlaylistContainer;\nvar _c;\n$RefreshReg$(_c, \"PlaylistContainer\");","map":{"version":3,"names":["useEffect","useState","PlaylistEntry","jsxDEV","_jsxDEV","client_id","client_secret","getPlaylistData","token","isNewToken","getParsedPlaylistData","playlistsData","authToken","Promise","all","items","map","playlist","tracks","fetch","href","method","headers","then","response","json","data","track","artists","artistName","name","artistUrl","external_urls","spotify","flat","artistSet","Set","filteredArtists","artist","has","add","push","playlistImg","images","playlistUrl","imageUrl","url","numPlaylists","parsedData","localStorage","setItem","JSON","stringify","catch","error","console","PlaylistContainer","_s","accessToken","setAccessToken","setData","setError","getAccessToken","URLSearchParams","append","body","log","ok","Error","status","access_token","fetchData","children","index","fileName","_jsxFileName","lineNumber","columnNumber","length","toString","_c","$RefreshReg$"],"sources":["/Users/simonhopkins/Desktop/Personal/react/music-i-listen-to/src/PlaylistContainer.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport PlaylistEntry from \"./PlaylistEntry\";\n\n\nconst client_id = '1b352e5ba35049b1918e0b310494107e';\nconst client_secret = 'b79d65aa4cca4e389c38ad01497bb981';\n\n\n\nasync function getPlaylistData(token, isNewToken) {\n    async function getParsedPlaylistData(playlistsData, authToken) {\n  \n      return Promise.all(playlistsData.items.map(async (playlist) => {\n        //get tracks\n        const tracks = await fetch(playlist.tracks.href, {\n          method: \"GET\",\n          headers: {\n            \"Authorization\": `Bearer ${authToken}`\n          }\n        })\n        .then(response => response.json())\n        .then(data => {\n          return data.items.map(track => track.track);\n        })\n        const artists = tracks.map((track) => {\n          return track.artists.map(artists => {\n            return{\n              artistName: artists.name,\n              artistUrl: artists.external_urls.spotify\n            }\n          });\n        }).flat();\n        let artistSet = new Set();\n        const filteredArtists = [];\n        for(const artist of artists){\n          if(!artistSet.has(artist.artistName)){\n            artistSet.add(artist.artistName);\n            filteredArtists.push(artist);\n          }\n        }\n  \n        const playlistImg = playlist.images[0];\n        const playlistUrl = playlist.external_urls.spotify;\n        return {\n          imageUrl: playlistImg.url,\n          playlistUrl: playlistUrl,\n          artists: filteredArtists\n        };\n      })).then(data => {\n        //song data\n        return data;\n      });\n    } //end get getParsedPlaylistData\n    \n    const numPlaylists = 3;\n    const url = `https://api.spotify.com/v1/users/simonlhopkins/playlists?limit=${numPlaylists}`;\n    //get the parsed data\n    return fetch(url, {\n      method: \"GET\",\n      headers: {\n        \"Authorization\": `Bearer ${token}`\n      }\n    })\n    .then(response => response.json())\n    .then(async (data) => {\n      const parsedData = await getParsedPlaylistData(data, token);\n      localStorage.setItem(\"cachedPlaylistData\", JSON.stringify(parsedData));\n      return parsedData;\n    })\n    .catch(error => console.error('Error:', error));\n  }\n\nfunction PlaylistContainer(){\n    const [accessToken, setAccessToken] = useState('');\n    const [data, setData] = useState([]);\n    const [error, setError] = useState(null);\n\n    async function getAccessToken() {\n        const data = new URLSearchParams();\n        data.append(\"grant_type\", \"client_credentials\");\n        data.append(\"client_id\", client_id);\n        data.append(\"client_secret\", client_secret);\n        return fetch(\"https://accounts.spotify.com/api/token\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          },\n          body: data\n      \n        }).then(response => {\n            console.log(response);\n            if (!response.ok) {\n                throw new Error(`HTTP error! Status: ${response.status}`);\n            }\n            return response.json();\n        })\n        .then(data => data.access_token)\n        .catch(error => {\n            throw error;\n        });\n    \n    }\n\n    useEffect(()=>{\n        const fetchData = async ()=>{\n            try{\n                const token = await getAccessToken();\n                setAccessToken(token);\n                const data = await getPlaylistData(token, true);\n                setData(data);\n            }\n            catch(error){\n                setError(error);\n                return;\n            }\n            \n        }\n        fetchData();\n    }, [])\n\n    const children = data.map((playlistsData, index)=>{\n        return (\n            <PlaylistEntry \n                key = {index}\n                imageUrl = {playlistsData.imageUrl}\n                artists = {playlistsData.artists}\n                playlistUrl = {playlistsData.playlistUrl} \n                />\n        )\n    });\n\n    console.log(children);\n    return(\n        <div>\n            {children.length>0 && children}\n            {error && <p>Error: {error.toString()}</p>}\n        </div>\n    )\n}\n\nexport default PlaylistContainer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}